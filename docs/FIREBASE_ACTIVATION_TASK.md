# üöÄ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –ó–∞–¥–∞–Ω–∏–µ: –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ë–∞–∑—ã –î–∞–Ω–Ω—ã—Ö Firebase

**–¶–µ–ª—å:** –£—Å—Ç—Ä–∞–Ω–∏—Ç—å –æ—à–∏–±–∫—É `PERMISSION_DENIED: Cloud Firestore API has not been used` –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –±—ç–∫–µ–Ω–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## 1. –°–æ–∑–¥–∞–Ω–∏–µ –ë–∞–∑—ã –î–∞–Ω–Ω—ã—Ö (Firestore)
–≠—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —à–∞–≥. –ë–µ–∑ –Ω–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –º–æ–∂–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∑–∞–∫–∞–∑—ã –∏ –∫–æ—Ä–∑–∏–Ω—É.

1.  –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Firebase Console](https://console.firebase.google.com/).
2.  –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç **`arbarea-mobile-app`**.
3.  –í –º–µ–Ω—é —Å–ª–µ–≤–∞ (—Ä–∞–∑–¥–µ–ª **Build**) –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ **Firestore Database**.
4.  –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **Create database**.
5.  **–®–∞–≥ 1: Location (–õ–æ–∫–∞—Ü–∏—è)**
    *   –í—ã–±–µ—Ä–∏—Ç–µ –±–ª–∏–∂–∞–π—à–∏–π –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Ä–µ–≥–∏–æ–Ω.
    *   –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è: `eur3 (europe-west)` –∏–ª–∏ –æ—Å—Ç–∞–≤—å—Ç–µ `nam5 (us-central)` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
    *   –ù–∞–∂–º–∏—Ç–µ *Next*.
6.  **–®–∞–≥ 2: Security Rules (–ü—Ä–∞–≤–∏–ª–∞)**
    *   –í—ã–±–µ—Ä–∏—Ç–µ **Start in production mode**.
    *   –ù–∞–∂–º–∏—Ç–µ **Create** (–∏–ª–∏ Enable).

‚è≥ *–ü–æ–¥–æ–∂–¥–∏—Ç–µ –ø–∞—Ä—É –º–∏–Ω—É—Ç, –ø–æ–∫–∞ –±–∞–∑–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è.*

---

## 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ü—Ä–∞–≤–∏–ª –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (Security Rules)
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ —Ä–µ–∂–∏–º–µ "Production" –±–∞–∑–∞ –∑–∞–∫—Ä—ã—Ç–∞ –¥–ª—è –≤—Å–µ—Ö. –ù–∞–º –Ω—É–∂–Ω–æ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.

1.  –í —Ä–∞–∑–¥–µ–ª–µ **Firestore Database** –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Rules**.
2.  –£–¥–∞–ª–∏—Ç–µ –≤–µ—Å—å —Ç–µ–∫—É—â–∏–π –∫–æ–¥ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ —ç—Ç–æ—Ç:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // –†–∞–∑—Ä–µ—à–∞–µ–º —á—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å –≤—Å–µ–º –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º (–≤–∫–ª—é—á–∞—è –∞–Ω–æ–Ω–∏–º–Ω—ã—Ö)
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
    
    // –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ (Products) - —á–∏—Ç–∞—Ç—å –º–æ–≥—É—Ç –≤—Å–µ, –ø–∏—Å–∞—Ç—å —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω (–ø–æ–∫–∞ –æ—Ç–∫—Ä—ã—Ç–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤)
    match /products/{productId} {
      allow read: if true;
      allow write: if request.auth != null; 
    }
  }
}
```
3.  –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **Publish**.

---

## 3. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –•—Ä–∞–Ω–∏–ª–∏—â–∞ (Storage)
–ù—É–∂–Ω–æ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤ (–µ—Å–ª–∏ –≤—ã –±—É–¥–µ—Ç–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏—Ö —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É –≤ –±—É–¥—É—â–µ–º).

1.  –í –º–µ–Ω—é —Å–ª–µ–≤–∞ (—Ä–∞–∑–¥–µ–ª **Build**) –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ **Storage**.
2.  –ù–∞–∂–º–∏—Ç–µ **Get started**.
3.  **Start in production mode** -> *Next*.
4.  **Cloud Storage location**: –û—Å—Ç–∞–≤—å—Ç–µ –∫–∞–∫ –µ—Å—Ç—å (–¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –±–∞–∑–æ–π) -> *Done*.
5.  –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Rules** –∏ –≤—Å—Ç–∞–≤—å—Ç–µ:

```javascript
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /{allPaths=**} {
      allow read: if true; // –ö–∞—Ä—Ç–∏–Ω–∫–∏ –≤–∏–¥–Ω—ã –≤—Å–µ–º
      allow write: if request.auth != null; // –ó–∞–≥—Ä—É–∂–∞—Ç—å –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏
    }
  }
}
```
6.  –ù–∞–∂–º–∏—Ç–µ **Publish**.

---

## 4. –§–∏–Ω–∞–ª—å–Ω–∞—è –ü—Ä–æ–≤–µ—Ä–∫–∞
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—É–Ω–∫—Ç–æ–≤ 1 –∏ 2:

1.  –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª VS Code.
2.  –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –ø—Ä–æ–≤–µ—Ä–∫–∏ –µ—â–µ —Ä–∞–∑:
    ```bash
    node scripts/test-firebase-sync.js
    ```

‚úÖ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** –ó–µ–ª–µ–Ω—ã–µ –≥–∞–ª–æ—á–∫–∏ –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ `DATABASE CONNECTION VERIFIED`.
