# üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ reCAPTCHA –¥–ª—è Firebase Phone Authentication

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ:

1. ‚úÖ reCAPTCHA Site Key –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.env.example`
2. ‚úÖ PhoneAuth –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç invisible reCAPTCHA
3. ‚úÖ reCAPTCHA –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

---

## üìã –í–∞—à reCAPTCHA Site Key:

```
6LeE9hUsAAAAAHq_EvnGtMdQAy-h27sTESsMLtWK
```

---

## üîß –î–æ–±–∞–≤—å—Ç–µ –∫–ª—é—á –≤ `.env` —Ñ–∞–π–ª:

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env` –∏ –¥–æ–±–∞–≤—å—Ç–µ:

```env
VITE_RECAPTCHA_SITE_KEY=6LeE9hUsAAAAAHq_EvnGtMdQAy-h27sTESsMLtWK
```

**–í–∞–∂–Ω–æ:** –≠—Ç–æ—Ç –∫–ª—é—á —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.env.example` –∫–∞–∫ –ø—Ä–∏–º–µ—Ä.

---

## üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ Firebase Console:

### 1. –î–æ–±–∞–≤—å—Ç–µ –¥–æ–º–µ–Ω—ã –≤ Firebase Authentication:

```
Firebase Console ‚Üí Authentication ‚Üí Settings ‚Üí Authorized domains
```

–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –¥–æ–º–µ–Ω—ã:
- `localhost` (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
- `arbarea-app.web.app` (–≤–∞—à production –¥–æ–º–µ–Ω)
- `arbarea-app.firebaseapp.com` (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –¥–æ–º–µ–Ω)

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Phone Authentication:

```
Firebase Console ‚Üí Authentication ‚Üí Sign-in method ‚Üí Phone
```

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
- ‚úÖ Phone provider –≤–∫–ª—é—á–µ–Ω
- ‚úÖ Test phone numbers –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

---

## üéØ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç reCAPTCHA –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:

### **Invisible reCAPTCHA:**

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **invisible** —Ä–µ–∂–∏–º reCAPTCHA, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

1. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å **–Ω–µ –≤–∏–¥–∏—Ç** –∫–∞–ø—á—É –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤
2. ‚úÖ Google –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –±–æ—Ç —ç—Ç–æ –∏–ª–∏ —á–µ–ª–æ–≤–µ–∫
3. ‚úÖ –ö–∞–ø—á–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
4. ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–π UX - –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∫–ª–∏–∫–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏

### **–ü—Ä–æ—Ü–µ—Å—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:**

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
   ‚Üì
2. –ù–∞–∂–∏–º–∞–µ—Ç "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥"
   ‚Üì
3. reCAPTCHA –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç (invisible)
   ‚Üì
4. Firebase –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç SMS —Å –∫–æ–¥–æ–º
   ‚Üì
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∫–æ–¥
   ‚Üì
6. –£—Å–ø–µ—à–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è!
```

---

## üîç –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è reCAPTCHA:

### **PhoneAuth.jsx:**

```javascript
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è reCAPTCHA
useEffect(() => {
    if (!window.recaptchaVerifier) {
        window.recaptchaVerifier = new RecaptchaVerifier(
            auth,
            'recaptcha-container',
            {
                size: 'invisible',  // –ù–µ–≤–∏–¥–∏–º—ã–π —Ä–µ–∂–∏–º
                callback: () => {
                    // reCAPTCHA —Ä–µ—à–µ–Ω–∞
                },
                'expired-callback': () => {
                    // –°–±—Ä–æ—Å –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏
                },
            }
        );
        window.recaptchaVerifier.render().catch(console.error);
    }
}, []);
```

### **HTML –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:**

```jsx
<div id="recaptcha-container"></div>
```

–≠—Ç–æ—Ç div —Å–ª—É–∂–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –¥–ª—è invisible reCAPTCHA.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

### **–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:**

```bash
npm run dev
```

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5173
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. –í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `+79991234567`
4. –ù–∞–∂–º–∏—Ç–µ "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥"
5. reCAPTCHA —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (invisible)
6. –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∏–∑ SMS

### **Production:**

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –Ω–∞ Firebase Hosting:

```bash
firebase deploy
```

–û—Ç–∫—Ä–æ–π—Ç–µ https://arbarea-app.web.app –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é.

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è:

### **1. –î–æ–º–µ–Ω—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã:**

–ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É:
```
reCAPTCHA client error: Invalid domain for site key
```

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ –¥–æ–º–µ–Ω –≤ Firebase Console ‚Üí Authentication ‚Üí Settings ‚Üí Authorized domains

### **2. –¢–µ—Å—Ç–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤:**

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö SMS:

```
Firebase Console ‚Üí Authentication ‚Üí Sign-in method ‚Üí Phone ‚Üí Test phone numbers
```

–î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–æ–º–µ—Ä –∏ –∫–æ–¥, –Ω–∞–ø—Ä–∏–º–µ—Ä:
- –ù–æ–º–µ—Ä: `+79991234567`
- –ö–æ–¥: `123456`

### **3. –õ–∏–º–∏—Ç—ã SMS:**

Firebase –∏–º–µ–µ—Ç –ª–∏–º–∏—Ç—ã –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É SMS:
- **–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω:** 10 SMS/–¥–µ–Ω—å
- **–ü–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω:** –ë–µ–∑–ª–∏–º–∏—Ç (–ø–ª–∞—Ç–Ω–æ –∑–∞ –∫–∞–∂–¥—É—é SMS)

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:

### **Firebase Console:**

```
Authentication ‚Üí Usage
```

–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–π
- –£—Å–ø–µ—à–Ω—ã–µ/–Ω–µ—É—Å–ø–µ—à–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ SMS

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

reCAPTCHA –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç invisible reCAPTCHA –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±–æ—Ç–æ–≤ –ø—Ä–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

**–ù–µ –∑–∞–±—É–¥—å—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á –≤ `.env` —Ñ–∞–π–ª!** üîë
